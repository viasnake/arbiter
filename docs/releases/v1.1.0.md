# Arbiter v1.1.0 Scope

## Scope

Arbiter v1.1.0 focuses on deterministic control-plane behavior and state observability.

- `/v1/contracts` metadata is generated from source-of-truth files (`contracts/v1/*`, `openapi/v1.yaml`).
- Job and approval state reads reflect persisted event streams.
- Action results are treated as stateful execution reports with idempotency and conflict semantics.
- Audit mirror semantics and verification UX are hardened.
- Test coverage is expanded around determinism, idempotency, and conflict behavior.

## Invariants

- Deterministic `process(input) -> ResponsePlan` for equivalent input + policy snapshot.
- Event-style inputs remain idempotent by `(tenant_id, event_id)`.
- Audit remains append-only and hash-chained (`prev_hash`, `record_hash`).
- No background state mutation; state changes require explicit input.

## Non-goals

- Arbiter still does not execute external actions.
- Arbiter does not add worker orchestration or job runtime management.
- Approval expiration is not background-driven; explicit events remain the source of truth.
- No v2 contract introduction in this release.

## API surface impacted

- Existing:
  - `GET /v1/contracts`
  - `POST /v1/job-events`
  - `POST /v1/approval-events`
  - `POST /v1/action-results`
  - `GET /v1/jobs/{tenant_id}/{job_id}`
  - `GET /v1/approvals/{tenant_id}/{approval_id}`
- Planned additive endpoint in this release:
  - `GET /v1/action-results/{tenant_id}/{plan_id}/{action_id}`

## Migration notes

- v1.x minor release policy is preserved (additive/non-breaking changes only).
- Existing clients should continue to work without payload contract changes.
- Clients should rely on documented idempotency and conflict response codes for retries.

## Acceptance checklist

- [ ] Contracts metadata is generated and stable for same repo state.
- [ ] Job state read path reflects persisted latest status with transition conflict handling.
- [ ] Approval state read path reflects persisted latest status with explicit expiration policy.
- [ ] Action results support idempotent ingest + mismatch conflict + retrieval.
- [ ] Audit mirror behavior and verification are deterministic and documented.
- [ ] CI includes contracts drift checks and authz resilience tests.
- [ ] Version and release artifacts are consistent for `1.1.0`.

## Release process notes

- Keep changes in small, reviewable commits using Conventional Commits.
- Before tagging, run local gates: `mise run ci`.
- Publish by pushing tag `v1.1.0` after version consistency updates.
